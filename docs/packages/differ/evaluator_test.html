<!DOCTYPE html>
<!--
 Copyright 2022 Red Hat, Inc

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->

<html>
<head>
<title>evaluator_test.go</title>
<meta charset="utf-8"/>
<style type="text/css">body {
    background: rgb(225, 225, 225);
    margin: 0px;
    padding: 0px;
}

#docgo p {
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 15px;
    margin-left: 0px;
}

#docgo div {
    display: inline;
}

#docgo #background {
    position: fixed;
    top: 0; left: 525px; right: 0; bottom: 0;
    background: rgb(47, 47, 47);
    border-left: 1px solid #e5e5ee;
    z-index: -1;
}

#docgo .keyword {
    color: rgb(250, 200, 100);
}

#docgo .literal {
    color: rgb(140, 190, 100);
}

#docgo .ident {
    color: white;
}

#docgo .operator {
    color: white;
}

#docgo .comment {
}

#docgo h1, h2, h3, h4, h5 {
    text-align: left;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 15px;
    margin-left: 0px;
}

#docgo h1 {
    margin-top: 40px;
}

#docgo .doc {
    vertical-align: top;
    font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
    font-size: 15px;
    line-height: 22px;
    color: black;
    min-width: 450px;
    max-width: 450px;
    padding-top: 10px;
    padding-right: 25px;
    padding-bottom: 1px;
    padding-left: 50px;
    overflow-x: hidden;
}

#docgo .code {
    min-width: 650px;
    max-width: 650px;
    padding-left: 25px;
    padding-right: 15px;
    border-left: 1px;
    overflow-x: hidden;
    vertical-align: top;
}

#docgo .code pre code  {
    font-size: 12px;
    line-height: 18px;
    font-family: Menlo, Monaco, Consolas, "Lucida Console", monospace;
    color: rgb(120, 120, 120);
}
</style>
</head>
<body>
<div id="docgo">
  <div id="background"></div>
  <table>
    <thead><tr><th class="doc"><h1>evaluator_test.go</h1></th><th class="code"></th></tr></thead>
    <tbody>
      
      <tr class="section">
	<td class="doc"></td>
	<td class="code"><pre><code><div class="comment">/*
Copyright Â© 2022 Red Hat, Inc.

Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/</div>

<div class="keyword">package</div> <div class="ident">differ</div><div class="operator"></div>

<div class="keyword">import</div> <div class="operator">(</div>
	<div class="literal">&#34;testing&#34;</div><div class="operator"></div>

	<div class="literal">&#34;github.com/stretchr/testify/assert&#34;</div><div class="operator"></div>
<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>TestEvaluatorDefaultExpression function checks the filter expression
evaluator for default expression used by Notification Service</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">TestEvaluatorDefaultExpression</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">const</div> <div class="ident">expression</div> <div class="operator">=</div> <div class="literal">&#34;totalRisk &gt;= totalRiskThreshold&#34;</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">totalRiskThreshold</div> <div class="operator">=</div> <div class="literal">3</div><div class="operator"></div>

	<div class="ident">thresholds</div> <div class="operator">:=</div> <div class="ident">EventThresholds</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="ident">totalRiskThreshold</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">eventValue</div> <div class="operator">:=</div> <div class="ident">EventValue</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="literal">3</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try all combinations of totalRisk</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">totalRisk</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">totalRisk</div> <div class="operator">&lt;=</div> <div class="literal">5</div><div class="operator">;</div> <div class="ident">totalRisk</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>update event value</p>
</td>
	<td class="code"><pre><code>		<div class="ident">eventValue</div><div class="operator">.</div><div class="ident">TotalRisk</div> <div class="operator">=</div> <div class="ident">totalRisk</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try to evaluate the expression</p>
</td>
	<td class="code"><pre><code>		<div class="ident">result</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">evaluateFilterExpression</div><div class="operator">(</div><div class="ident">expression</div><div class="operator">,</div>
			<div class="ident">thresholds</div><div class="operator">,</div> <div class="ident">eventValue</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>expression should be evaluated w/o errors</p>
</td>
	<td class="code"><pre><code>		<div class="ident">assert</div><div class="operator">.</div><div class="ident">NoError</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">,</div> <div class="literal">&#34;Error is not expected there&#34;</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>repeat the expression, but now in Go</p>
</td>
	<td class="code"><pre><code>		<div class="keyword">if</div> <div class="ident">totalRisk</div> <div class="operator">&gt;=</div> <div class="ident">totalRiskThreshold</div> <div class="operator">{</div>
			<div class="ident">assert</div><div class="operator">.</div><div class="ident">Equal</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="literal">1</div><div class="operator">,</div> <div class="ident">result</div><div class="operator">,</div> <div class="literal">&#34;Result should be 1&#34;</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div> <div class="keyword">else</div> <div class="operator">{</div>
			<div class="ident">assert</div><div class="operator">.</div><div class="ident">Equal</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="literal">0</div><div class="operator">,</div> <div class="ident">result</div><div class="operator">,</div> <div class="literal">&#34;Result should be 0&#34;</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>TestEvaluatorComplicatedExpression function checks the filter expression
evaluator for custom expression</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">TestEvaluatorComplicatedExpression</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">const</div> <div class="ident">expression</div> <div class="operator">=</div> <div class="literal">&#34;totalRisk &gt;= totalRiskThreshold &amp;&amp; likelihood&#43;2 &gt; likelihoodThreshold&#34;</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">totalRiskThreshold</div> <div class="operator">=</div> <div class="literal">3</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">likelihoodThreshold</div> <div class="operator">=</div> <div class="literal">2</div><div class="operator"></div>

	<div class="ident">thresholds</div> <div class="operator">:=</div> <div class="ident">EventThresholds</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="ident">likelihoodThreshold</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="ident">totalRiskThreshold</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">eventValue</div> <div class="operator">:=</div> <div class="ident">EventValue</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="literal">0</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try all combinations of likelihood and totalRisk</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">likelihood</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">likelihood</div> <div class="operator">&lt;=</div> <div class="literal">5</div><div class="operator">;</div> <div class="ident">likelihood</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
		<div class="keyword">for</div> <div class="ident">totalRisk</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">totalRisk</div> <div class="operator">&lt;=</div> <div class="literal">5</div><div class="operator">;</div> <div class="ident">totalRisk</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>update event value</p>
</td>
	<td class="code"><pre><code>			<div class="ident">eventValue</div><div class="operator">.</div><div class="ident">TotalRisk</div> <div class="operator">=</div> <div class="ident">totalRisk</div><div class="operator"></div>
			<div class="ident">eventValue</div><div class="operator">.</div><div class="ident">Likelihood</div> <div class="operator">=</div> <div class="ident">likelihood</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try to evaluate the expression</p>
</td>
	<td class="code"><pre><code>			<div class="ident">result</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">evaluateFilterExpression</div><div class="operator">(</div><div class="ident">expression</div><div class="operator">,</div>
				<div class="ident">thresholds</div><div class="operator">,</div> <div class="ident">eventValue</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>expression should be evaluated w/o errors</p>
</td>
	<td class="code"><pre><code>			<div class="ident">assert</div><div class="operator">.</div><div class="ident">NoError</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">,</div> <div class="literal">&#34;Error is not expected there&#34;</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>repeat the expression, but now in Go</p>
</td>
	<td class="code"><pre><code>			<div class="keyword">if</div> <div class="ident">totalRisk</div> <div class="operator">&gt;=</div> <div class="ident">totalRiskThreshold</div> <div class="operator">&amp;&amp;</div> <div class="ident">likelihood</div><div class="operator">&#43;</div><div class="literal">2</div> <div class="operator">&gt;</div> <div class="ident">likelihoodThreshold</div> <div class="operator">{</div>
				<div class="ident">assert</div><div class="operator">.</div><div class="ident">Equal</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="literal">1</div><div class="operator">,</div> <div class="ident">result</div><div class="operator">,</div> <div class="literal">&#34;Result should be 1&#34;</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div> <div class="keyword">else</div> <div class="operator">{</div>
				<div class="ident">assert</div><div class="operator">.</div><div class="ident">Equal</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="literal">0</div><div class="operator">,</div> <div class="ident">result</div><div class="operator">,</div> <div class="literal">&#34;Result should be 0&#34;</div><div class="operator">)</div><div class="operator"></div>
			<div class="operator">}</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>TestEvaluatorEmptyExpression function checks the filter expression
evaluator for expression that is empty</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">TestEvaluatorEmptyExpression</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">const</div> <div class="ident">expression</div> <div class="operator">=</div> <div class="literal">&#34;&#34;</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">totalRiskThreshold</div> <div class="operator">=</div> <div class="literal">3</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">likelihoodThreshold</div> <div class="operator">=</div> <div class="literal">2</div><div class="operator"></div>

	<div class="ident">thresholds</div> <div class="operator">:=</div> <div class="ident">EventThresholds</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="ident">likelihoodThreshold</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="ident">totalRiskThreshold</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">eventValue</div> <div class="operator">:=</div> <div class="ident">EventValue</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="literal">0</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try all combinations of likelihood and totalRisk</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">likelihood</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">likelihood</div> <div class="operator">&lt;=</div> <div class="literal">5</div><div class="operator">;</div> <div class="ident">likelihood</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
		<div class="keyword">for</div> <div class="ident">totalRisk</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">totalRisk</div> <div class="operator">&lt;=</div> <div class="literal">5</div><div class="operator">;</div> <div class="ident">totalRisk</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>update event value</p>
</td>
	<td class="code"><pre><code>			<div class="ident">eventValue</div><div class="operator">.</div><div class="ident">TotalRisk</div> <div class="operator">=</div> <div class="ident">totalRisk</div><div class="operator"></div>
			<div class="ident">eventValue</div><div class="operator">.</div><div class="ident">Likelihood</div> <div class="operator">=</div> <div class="ident">likelihood</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try to evaluate the expression</p>
</td>
	<td class="code"><pre><code>			<div class="ident">_</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">evaluateFilterExpression</div><div class="operator">(</div><div class="ident">expression</div><div class="operator">,</div>
				<div class="ident">thresholds</div><div class="operator">,</div> <div class="ident">eventValue</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>error should be reported for incorrect expression</p>
</td>
	<td class="code"><pre><code>			<div class="ident">assert</div><div class="operator">.</div><div class="ident">Error</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">,</div> <div class="literal">&#34;Error is expected there&#34;</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>TestEvaluatorIncorrectExpression function checks the filter expression
evaluator for expression that is not correct</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">TestEvaluatorIncorrectExpression</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>this is wrong expression</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">const</div> <div class="ident">expression</div> <div class="operator">=</div> <div class="literal">&#34;totalRisk &gt;=&#34;</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">totalRiskThreshold</div> <div class="operator">=</div> <div class="literal">3</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">likelihoodThreshold</div> <div class="operator">=</div> <div class="literal">2</div><div class="operator"></div>

	<div class="ident">thresholds</div> <div class="operator">:=</div> <div class="ident">EventThresholds</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="ident">likelihoodThreshold</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="ident">totalRiskThreshold</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">eventValue</div> <div class="operator">:=</div> <div class="ident">EventValue</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="literal">0</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try all combinations of likelihood and totalRisk</p>
</td>
	<td class="code"><pre><code>	<div class="keyword">for</div> <div class="ident">likelihood</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">likelihood</div> <div class="operator">&lt;=</div> <div class="literal">5</div><div class="operator">;</div> <div class="ident">likelihood</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
		<div class="keyword">for</div> <div class="ident">totalRisk</div> <div class="operator">:=</div> <div class="literal">0</div><div class="operator">;</div> <div class="ident">totalRisk</div> <div class="operator">&lt;=</div> <div class="literal">5</div><div class="operator">;</div> <div class="ident">totalRisk</div><div class="operator">&#43;&#43;</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>update event value</p>
</td>
	<td class="code"><pre><code>			<div class="ident">eventValue</div><div class="operator">.</div><div class="ident">TotalRisk</div> <div class="operator">=</div> <div class="ident">totalRisk</div><div class="operator"></div>
			<div class="ident">eventValue</div><div class="operator">.</div><div class="ident">Likelihood</div> <div class="operator">=</div> <div class="ident">likelihood</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try to evaluate the expression</p>
</td>
	<td class="code"><pre><code>			<div class="ident">_</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">evaluateFilterExpression</div><div class="operator">(</div><div class="ident">expression</div><div class="operator">,</div>
				<div class="ident">thresholds</div><div class="operator">,</div> <div class="ident">eventValue</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>error should be reported for incorrect expression</p>
</td>
	<td class="code"><pre><code>			<div class="ident">assert</div><div class="operator">.</div><div class="ident">Error</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">,</div> <div class="literal">&#34;Error is expected there&#34;</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">type</div> <div class="ident">TestCase</div> <div class="keyword">struct</div> <div class="operator">{</div>
	<div class="ident">name</div>          <div class="ident">string</div><div class="operator"></div>
	<div class="ident">expression</div>    <div class="ident">string</div><div class="operator"></div>
	<div class="ident">expectedValue</div> <div class="ident">int</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>TestEvaluatorRelational checks the evaluator.Evaluate function for simple
relational expression</p>
</td>
	<td class="code"><pre><code><div class="keyword">func</div> <div class="ident">TestEvaluatorRelational</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="ident">testCases</div> <div class="operator">:=</div> <div class="operator">[</div><div class="operator">]</div><div class="ident">TestCase</div><div class="operator">{</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;less than&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &lt; totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">1</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;less then or equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &lt;= totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">1</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk == totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;greater or equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &gt;= totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;greater than&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &gt; totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;not equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk != totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">1</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;arithmetic &#43; less than&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &#43; 1 &lt; totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;arithmetic &#43; less then or equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &#43; 1 &lt;= totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">1</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;arithmetic &#43; equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &#43; 1 == totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">1</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;arithmetic &#43; greater or equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &#43; 1 &gt;= totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">1</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;arithmetic &#43; greater than&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &#43; 1 &gt; totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">{</div>
			<div class="ident">name</div><div class="operator">:</div>          <div class="literal">&#34;arithmetic &#43; not equal&#34;</div><div class="operator">,</div>
			<div class="ident">expression</div><div class="operator">:</div>    <div class="literal">&#34;totalRisk &#43; 1 != totalRiskThreshold&#34;</div><div class="operator">,</div>
			<div class="ident">expectedValue</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="keyword">const</div> <div class="ident">totalRiskThreshold</div> <div class="operator">=</div> <div class="literal">3</div><div class="operator"></div>
	<div class="keyword">const</div> <div class="ident">totalRisk</div> <div class="operator">=</div> <div class="literal">2</div><div class="operator"></div>

	<div class="ident">thresholds</div> <div class="operator">:=</div> <div class="ident">EventThresholds</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="ident">totalRiskThreshold</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="ident">eventValue</div> <div class="operator">:=</div> <div class="ident">EventValue</div><div class="operator">{</div>
		<div class="ident">Likelihood</div><div class="operator">:</div> <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Impact</div><div class="operator">:</div>     <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">Severity</div><div class="operator">:</div>   <div class="literal">0</div><div class="operator">,</div>
		<div class="ident">TotalRisk</div><div class="operator">:</div>  <div class="ident">totalRisk</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator"></div>

	<div class="keyword">for</div> <div class="ident">_</div><div class="operator">,</div> <div class="ident">tc</div> <div class="operator">:=</div> <div class="keyword">range</div> <div class="ident">testCases</div> <div class="operator">{</div>
		<div class="ident">t</div><div class="operator">.</div><div class="ident">Run</div><div class="operator">(</div><div class="ident">tc</div><div class="operator">.</div><div class="ident">name</div><div class="operator">,</div> <div class="keyword">func</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>try to evaluate the expression</p>
</td>
	<td class="code"><pre><code>			<div class="ident">result</div><div class="operator">,</div> <div class="ident">err</div> <div class="operator">:=</div> <div class="ident">evaluateFilterExpression</div><div class="operator">(</div><div class="ident">tc</div><div class="operator">.</div><div class="ident">expression</div><div class="operator">,</div>
				<div class="ident">thresholds</div><div class="operator">,</div> <div class="ident">eventValue</div><div class="operator">)</div><div class="operator"></div>
			<div class="ident">assert</div><div class="operator">.</div><div class="ident">NoError</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">,</div> <div class="literal">&#34;unexpected error&#34;</div><div class="operator">)</div><div class="operator"></div>
			<div class="ident">assert</div><div class="operator">.</div><div class="ident">Equal</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">tc</div><div class="operator">.</div><div class="ident">expectedValue</div><div class="operator">,</div> <div class="ident">result</div><div class="operator">)</div><div class="operator"></div>
		<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
	<div class="operator">}</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
    </tbody>
  </table>
</div>
</body>
</html>
